webpackJsonp([0],{"./app/containers/CSAccountsPage/index.js":function(e,t,n){"use strict";function r(e,t){return{type:re,key:e,value:t}}function o(){return{type:oe}}function s(){return{type:se}}function a(e){return{type:ae,users:e}}function c(){return{type:ce}}function u(e){return{type:ue,roles:e}}function i(){return{type:ie}}function l(e,t){return{type:le,user:e,data:t}}function p(e){return{type:pe,user:e}}function d(e){return{type:de,user:e}}function f(e,t){return{type:fe,user:e,newPassword:t}}function b(){return{type:be}}function m(e){return{type:me,user:e}}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments[1];switch(t.type){case ae:return e.set("users",Object(Z.fromJS)(t.users));case ue:return e.set("roles",Object(Z.fromJS)(t.roles));case re:return e.setIn(["form","user",t.key],t.value);case oe:return e.setIn(["form","isOpen"],Object(Z.fromJS)(!1));case be:return e.setIn(["form","isOpen"],!0).setIn(["form","user"],Object(Z.fromJS)({})).setIn(["form","status"],ne.CREATE);case me:return e.setIn(["form","isOpen"],Object(Z.fromJS)(!0)).setIn(["form","user"],Object(Z.fromJS)(t.user)).setIn(["form","status"],ne.EDIT);default:return e}}function h(){var e,t,n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e=Object(ve.a)(Te.GET_USERS),r.next=4,Object(Ce.a)(ve.b,Te.GET_USERS.URL,e);case 4:return t=r.sent,n=(t.data||[]).map(function(e){return{name:e.name,email:e.email,role:e.role.type,role_name:e.role.name,last_login:e.last_login,status:e.status}}),r.next=8,Object(Ce.b)(a(n));case 8:return r.next=10,Object(Ce.b)(Object(Se.b)({mess:"Load list CS Accounts SUCCESS!"}));case 10:r.next=16;break;case 12:return r.prev=12,r.t0=r.catch(0),r.next=16,Object(Ce.b)(Object(Se.b)({type:Se.b.TYPE.ERROR,mess:r.t0.error}));case 16:case"end":return r.stop()}},ye,this,[[0,12]])}function j(){var e,t,n,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(Ce.c)(Object(ge.c)());case 3:return e=o.sent,t=Object(ve.a)(Te.ROLES,e),o.next=7,Object(Ce.a)(ve.b,Te.ROLES.URL,t);case 7:return n=o.sent,r=n.data.map(function(e){return{label:e.name,value:e.type}}),o.next=11,Object(Ce.b)(u(r));case 11:o.next=17;break;case 13:return o.prev=13,o.t0=o.catch(0),o.next=17,Object(Ce.b)(Object(Se.b)({type:"",mess:o.t0.error}));case 17:case"end":return o.stop()}},Ee,this,[[0,13]])}function C(e){var t,n,r,a,c,u,i;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,Object(Ce.c)(Object(ge.c)());case 3:return t=l.sent,l.next=6,Object(Ce.c)(te());case 6:return n=l.sent,r=e?Te.UPDATE:Te.CREATE,a={email:n.email,password:n.password,name:n.name,role:n.role},e&&(a={email:n.email,name:n.name,role:n.role}),c=Object(ve.a)(r,t,a),l.next=13,Object(Ce.a)(ve.b,r.URL,c);case 13:return u=l.sent,l.next=16,Object(Ce.b)(Object(Se.b)({type:"",mess:e?"Update user SUCCESS!":"Create User SUCCESS!"}));case 16:return l.next=18,Object(Ce.b)(s());case 18:return l.next=20,Object(Ce.b)(o());case 20:l.next=29;break;case 22:return l.prev=22,l.t0=l.catch(0),l.next=26,l.t0;case 26:return i=l.sent,l.next=29,Object(Ce.b)(Object(Se.b)({type:"",mess:i.error}));case 29:case"end":return l.stop()}},xe,this,[[0,22]])}function v(){var e,t,n,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Ce.c)(Object(ge.c)());case 3:return e=a.sent,a.next=6,Object(Ce.c)(te());case 6:return t=a.sent,n=Object(ve.a)(Te.BLOCK,e,{email:t.email}),a.next=10,Object(Ce.a)(ve.b,Te.BLOCK.URL,n);case 10:return r=a.sent,a.next=13,Object(Ce.b)(Object(Se.b)({type:"",mess:"Block user SUCCESS!"}));case 13:return a.next=15,Object(Ce.b)(s());case 15:return a.next=17,Object(Ce.b)(o());case 17:a.next=23;break;case 19:return a.prev=19,a.t0=a.catch(0),a.next=23,Object(Ce.b)(Object(Se.b)({type:"",mess:a.t0.error}));case 23:case"end":return a.stop()}},_e,this,[[0,19]])}function S(){var e,t,n,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Ce.c)(Object(ge.c)());case 3:return e=a.sent,a.next=6,Object(Ce.c)(te());case 6:return t=a.sent,n=Object(ve.a)(Te.UNBLOCK,e,{email:t.email}),a.next=10,Object(Ce.a)(ve.b,Te.UNBLOCK.URL,n);case 10:return r=a.sent,a.next=13,Object(Ce.b)(Object(Se.b)({type:"",mess:"UnBlock user SUCCESS!"}));case 13:return a.next=15,Object(Ce.b)(s());case 15:return a.next=17,Object(Ce.b)(o());case 17:a.next=23;break;case 19:return a.prev=19,a.t0=a.catch(0),a.next=23,Object(Ce.b)(Object(Se.b)({type:"",mess:a.t0.error}));case 23:case"end":return a.stop()}},we,this,[[0,19]])}function g(){var e,t,n,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Ce.c)(Object(ge.c)());case 3:return e=a.sent,a.next=6,Object(Ce.c)(te());case 6:return t=a.sent,n=Object(ve.a)(Te.CHANGE_PASSWORD,e,{email:t.email,password:t.password}),a.next=10,Object(Ce.a)(ve.b,Te.CHANGE_PASSWORD.URL,n);case 10:return r=a.sent,a.next=13,Object(Ce.b)(Object(Se.b)({type:"",mess:"Reset password SUCCESS!"}));case 13:return a.next=15,Object(Ce.b)(s());case 15:return a.next=17,Object(Ce.b)(o());case 17:a.next=23;break;case 19:return a.prev=19,a.t0=a.catch(0),a.next=23,Object(Ce.b)(Object(Se.b)({type:"",mess:"Reset password FAIL!\n"+a.t0.error}));case 23:case"end":return a.stop()}},Re,this,[[0,19]])}function E(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(Ce.d)(se,h),Object(Ce.d)(ce,j),Object(Ce.d)(ie,C,!1),Object(Ce.d)(le,C,!0),Object(Ce.d)(pe,v),Object(Ce.d)(de,S),Object(Ce.d)(fe,g)];case 2:case"end":return e.stop()}},Ae,this)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function R(e){return{loadRoles:function(){return e(c())},changeField:function(t,n){return e(r(t,n))},closeForm:function(){return e(o())},createCSAccount:function(){return e(i())},updateCSAccount:function(){return e(l())},blockCSAccount:function(){return e(p())},unBlockCSAccount:function(){return e(d())},resetPasswordCSAccount:function(){return e(f())}}}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function k(e){return{getListUsers:function(){return e(s())},createUser:function(){return e(b())},editUser:function(t){return e(m(t))}}}Object.defineProperty(t,"__esModule",{value:!0});var P=n("./node_modules/react/index.js"),D=n.n(P),L=(n("./node_modules/prop-types/index.js"),n("./node_modules/moment/src/moment.js")),N=n("./node_modules/@atlaskit/select/dist/cjs/index.js"),I=n.n(N),H=n("./node_modules/styled-components/dist/styled-components.browser.es.js"),M=n("./node_modules/@atlaskit/button/dist/cjs/index.js"),B=n.n(M),F=n("./node_modules/@atlaskit/page-header/dist/cjs/index.js"),J=n.n(F),G=n("./node_modules/react-router/index.js"),K=n("./node_modules/@atlaskit/icon/glyph/page-filled.js"),W=n.n(K),Q=n("./node_modules/react-table/lib/index.js"),V=n.n(Q),Y=n("./node_modules/reselect/es/index.js"),q=n("./node_modules/react-redux/es/index.js"),$=n("./node_modules/redux/es/index.js"),z=n("./app/utils/injectReducer.js"),X=n("./app/utils/injectSaga.js"),Z=n("./node_modules/immutable/dist/immutable.js"),ee=function(e){return e.get("CSAccounts")},te=function(){return Object(Y.a)(ee,function(e){return e.get("form").get("user",Object(Z.fromJS)([])).toJS()})},ne={NONE:"NONE",EDIT:"EDIT",CREATE:"CREATE",VIEW:"VIEW"},re="csp/CSAccount/CHANGE_FIELD_CURRENT_USER",oe="csp/CSAccount/CLOSE_FORM",se="csp/CSAccount/REQUEST_LIST_CS_ACCOUNTS",ae="csp/CSAccount/LOADED_LIST_CS_ACCOUNTS",ce="csp/CSAccount/REQUEST_LIST_ROLES",ue="csp/CSAccount/LOADED_LIST_ROLES",ie="csp/CSAccount/REQUEST_CREATE_CS_ACCOUNT",le="csp/CSAccount/REQUEST_UPDATE_CS_ACCOUNT",pe="csp/CSAccount/REQUEST_BLOCK_CS_ACCOUNT",de="csp/CSAccount/REQUEST_UNBLOCK_CS_ACCOUNT",fe="csp/CSAccount/REQUEST_RESET_PASSWORD",be="csp/CSAccount/FORM_CREATE_NEW_USER",me="csp/CSAccount/FORM_EDIT_USER",Oe=[{label:"Admin",value:"ADMIN"},{label:"CS Agent",value:"CS_AGENT"},{label:"ReadOnly",value:"READONLY"}],he=Object(Z.fromJS)({searchUser:"",users:[],form:{status:ne.NONE,isOpen:!1,user:{name:"",email:"",password:"",role:""}},selectedUsers:[],roles:Oe}),je=O,Ce=n("./node_modules/redux-saga/es/effects.js"),ve=n("./app/utils/request.js"),Se=n("./app/containers/App/actions.js"),ge=n("./app/containers/App/selectors.js"),ye=regeneratorRuntime.mark(h),Ee=regeneratorRuntime.mark(j),xe=regeneratorRuntime.mark(C),_e=regeneratorRuntime.mark(v),we=regeneratorRuntime.mark(S),Re=regeneratorRuntime.mark(g),Ae=regeneratorRuntime.mark(E),Te={GET_USERS:{URL:"/api/v1/admin/users",METHOD:"GET"},CREATE:{URL:"/api/v1/admin/users",METHOD:"POST"},UPDATE:{URL:"/api/v1/admin/users",METHOD:"PATCH"},BLOCK:{URL:"/api/v1/admin/users/block",METHOD:"PATCH"},UNBLOCK:{URL:"/api/v1/admin/users/unblock",METHOD:"PATCH"},CHANGE_PASSWORD:{URL:"/api/v1/admin/users/password/reset",METHOD:"PATCH"},ROLES:{URL:"/api/v1/admin/roles",METHOD:"GET"}},Ue=n("./node_modules/@atlaskit/field-text/dist/cjs/index.js"),ke=n.n(Ue),Pe=n("./node_modules/@atlaskit/modal-dialog/dist/cjs/index.js"),De=n.n(Pe),Le=n("./app/utils/toast.js"),Ne=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,r,o){var s=t&&t.defaultProps,a=arguments.length-3;if(n||0===a||(n={}),n&&s)for(var c in s)void 0===n[c]&&(n[c]=s[c]);else n||(n=s||{});if(1===a)n.children=o;else if(a>1){for(var u=Array(a),i=0;i<a;i++)u[i]=arguments[i+3];n.children=u}return{$$typeof:e,type:t,key:void 0===r?null:""+r,ref:null,props:n,_owner:null}}}(),Ie=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),He=Ne("label",{htmlFor:"role"},void 0,Ne("div",{},void 0,"Select role")),Me=function(e){function t(){var e,n,r,o;x(this,t);for(var s=arguments.length,a=Array(s),c=0;c<s;c++)a[c]=arguments[c];return n=r=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={isChangePass:!1,password:""},r.close=function(){r.setState({isChangePass:!1,password:""},function(){r.props.closeForm()})},r.create=function(){r.props.createCSAccount()},r.update=function(){r.props.updateCSAccount()},r.block=function(){r.props.blockCSAccount(),y},r.unBlock=function(){r.props.unBlockCSAccount()},r.resetPassword=function(){return r.state.isChangePass?r.state.password!==r.props.user.password?void Object(Le.a)("Your password and confirmation password do not match!","warning"):void r.props.resetPasswordCSAccount():(r.props.changeField("password",""),void r.setState({isChangePass:!0,password:""}))},o=n,_(r,o)}return w(t,e),Ie(t,[{key:"componentDidMount",value:function(){this.props.loadRoles()}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,r=t.roles,o=n.isOpen,s=n.status,a=this.state.isChangePass,c=this.props.user,u=this.props.changeField,i=[{text:"Create",appearance:"primary",isDisabled:s!==ne.CREATE,onClick:this.create},{text:"Update",appearance:"warning",isDisabled:s!==ne.EDIT||a,onClick:this.update},{text:"Block",appearance:"danger",isDisabled:s!==ne.EDIT,onClick:this.block},{text:"UnBlock",appearance:"warning",isDisabled:s!==ne.EDIT,onClick:this.unBlock},{text:"Reset password",appearance:"warning",isDisabled:s!==ne.EDIT,onClick:this.resetPassword}],l=s===ne.CREATE?"Add user":"User information";return o&&Ne(De.a,{actions:i,onClose:this.close,heading:l,height:"100%"},void 0,a?Ne("div",{},void 0,Ne(Ue.FieldTextStateless,{label:"New password",type:"password",value:c.password,required:!0,shouldFitContainer:!0,onChange:function(e){return u("password",e.target.value)}}),Ne(Ue.FieldTextStateless,{label:"Retype password",type:"password",value:this.state.password,required:!0,shouldFitContainer:!0,onChange:function(t){return e.setState({password:t.target.value})}})):Ne("div",{},void 0,Ne(ke.a,{label:"Name",value:c.name,required:!0,shouldFitContainer:!0,onChange:function(e){return u("name",e.target.value)}}),Ne(ke.a,{label:"Email",value:c.email,disabled:ne.EDIT===s,required:!0,shouldFitContainer:!0,onChange:function(e){return u("email",e.target.value)}}),s!==ne.EDIT&&Ne(ke.a,{label:"Password",value:c.password,type:"password",required:!0,shouldFitContainer:!0,onChange:function(e){return u("password",e.target.value)}}),He,Ne(I.a,{defaultValue:r.find(function(e){return e.value===c.role}),onChange:function(e){return u("role",e.value)},getOptionValue:function(e){return e.value},options:r,isSearchable:!1,placeholder:"Select role",maxMenuHeight:200})))}}]),t}(D.a.PureComponent),Be=Object(Y.b)({form:function(){return Object(Y.a)(ee,function(e){return e.get("form").toJS()})}(),user:te(),roles:function(){return Object(Y.a)(ee,function(e){return e.get("roles").toJS()})}()}),Fe=Object(q.b)(Be,R)(Me);n("./app/containers/CSAccountsPage/style.css");t.mapDispatchToProps=k;var Je=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ge=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,r,o){var s=t&&t.defaultProps,a=arguments.length-3;if(n||0===a||(n={}),n&&s)for(var c in s)void 0===n[c]&&(n[c]=s[c]);else n||(n=s||{});if(1===a)n.children=o;else if(a>1){for(var u=Array(a),i=0;i<a;i++)u[i]=arguments[i+3];n.children=u}return{$$typeof:e,type:t,key:void 0===r?null:""+r,ref:null,props:n,_owner:null}}}(),Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},We=H.default.div.withConfig({displayName:"CSAccountsPage__Hr"})(["height:1px;background-color:#ddd;margin:2em 0;"]),Qe=function(){return{alignItems:"center",display:"flex",":before":{backgroundColor:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#ccc",borderRadius:10,content:" ",display:"block",marginRight:8,height:10,width:10}}},Ve={control:function(e){return Ke({},e,{backgroundColor:"white",borderColor:"#0052CC",borderWidth:2})},input:function(e){return Ke({},e,Qe())},placeholder:function(e){return Ke({},e,Qe())},singleValue:function(e,t){var n=t.data;return Ke({},e,Qe(n.color))}},Ye=function(e){var t=e.actions;return Ge(M.ButtonGroup,{},void 0,t.map(function(e){return D.a.createElement(B.a,Ke({key:e.text},e),e.text)}))},qe=Ge(W.a,{}),$e=Ge(We,{}),ze=Ge("br",{}),Xe=Ge(Fe,{}),Ze=function(e){function t(){var e,n,r,o;A(this,t);for(var s=arguments.length,a=Array(s),c=0;c<s;c++)a[c]=arguments[c];return n=r=T(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.createNewUser=function(){r.props.createUser()},r.editUser=function(e){r.props.editUser(e)},r.actions=[{text:"Create User",appearance:"primary",iconBefore:qe,onClick:function(){return r.createNewUser()}}],o=n,T(r,o)}return U(t,e),Je(t,[{key:"componentDidMount",value:function(){this.props.getListUsers()}},{key:"render",value:function(){var e=this;return Ge("div",{style:{margin:20}},void 0,Ge(J.a,{actions:Ge(Ye,{actions:this.actions})},void 0,"Customer Service Account Manager"),Ge(I.a,{options:this.props.users,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.email},placeholder:"Search users",styles:Ve}),$e,Ge("div",{},void 0,Ge(V.a,{data:this.props.users,columns:[{Header:"Name",accessor:"name",Cell:function(e){return Ge("span",{},void 0,e.value)}},{Header:"Email",accessor:"email"},{Header:"Role",accessor:"role_name",Cell:function(e){return Ge("span",{},void 0,e.value||"Not yet")}},{Header:"Last Login",accessor:"last_login",Cell:function(e){return Ge("span",{},void 0,e.value&&Object(L.a)(+e.value).format("HH:mm DD/MM/YYYY")||"UNKNOW")}}],noDataText:"No data",defaultPageSize:10,className:"-striped -highlight",getTrProps:function(t,n){return{onClick:function(){e.editUser(n.original)},className:"1"!==(((n||{}).original||{}).status||"1")?"strikeout":""}}}),ze),Xe)}}]),t}(D.a.PureComponent),et=Object(Y.b)({users:function(){return Object(Y.a)(ee,function(e){return e.get("users").toJS()})}()}),tt=Object(q.b)(et,k),nt=Object(z.a)({key:"CSAccounts",reducer:je}),rt=Object(X.a)({key:"CSAccounts",saga:E});t.default=Object($.c)(G.withRouter,nt,rt,tt)(Ze)},"./app/containers/CSAccountsPage/style.css":function(e,t,n){var r=n("./node_modules/css-loader/index.js!./app/containers/CSAccountsPage/style.css");"string"==typeof r&&(r=[[e.i,r,""]]);var o={};o.transform=void 0;n("./node_modules/style-loader/lib/addStyles.js")(r,o);r.locals&&(e.exports=r.locals)},"./node_modules/@atlaskit/icon/glyph/page-filled.js":function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n("./node_modules/react/index.js"),a=r(s),c=n("./node_modules/@atlaskit/icon/es5/index.js"),u=r(c),i=function(e){return a.default.createElement(u.default,o({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" focusable="false" role="presentation"><g fill-rule="evenodd"><path d="M5 3.99C5 2.892 5.897 2 7.006 2h9.988C18.102 2 19 2.898 19 3.99v16.02c0 1.099-.897 1.99-2.006 1.99H7.006A2.003 2.003 0 0 1 5 20.01V3.99z" fill="currentColor"/><rect fill="inherit" x="8" y="6" width="8" height="2" rx="1"/><rect fill="inherit" x="8" y="9" width="8" height="2" rx="1"/><rect fill="inherit" x="8" y="12" width="4" height="2" rx="1"/></g></svg>'},e))};t.default=i},"./node_modules/css-loader/index.js!./app/containers/CSAccountsPage/style.css":function(e,t,n){t=e.exports=n("./node_modules/css-loader/lib/css-base.js")(void 0),t.push([e.i,"div.strikeout{background:#ff5000!important;text-decoration:line-through}div.strikeout:hover{background:#ff6751!important}",""])}});